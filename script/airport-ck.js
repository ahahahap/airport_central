var app=angular.module("airportApp",[]);app.factory("flightSearch",["$http",function(e){}]);app.controller("airportController",function(e,t,n){e.display=!1;e.airports=[{name:"Vancouver International Airport",code:"YVR"},{name:"Toronto Pearson International Airport",code:"YYZ"}];e.airlines=[{code:"EI",name:"Aer Lingus"},{code:"AC",name:"Air Canada"},{code:"CA",name:"Air China"},{code:"AF",name:"Air France"},{code:"NZ",name:"Air New Zealand"},{code:"4N",name:"Air North"},{code:"FJ",name:"Air Pacific"},{code:"TS",name:"Air Transat"},{code:"AS",name:"Alaska Airlines"},{code:"NH",name:"All Nippon Airways"},{code:"AA",name:"American Airlines"},{code:"OZ",name:"Asiana Airlines"},{code:"OS",name:"Austrian Airlines"},{code:"BA",name:"British Airways"},{code:"181",name:"Canadian Air Charters"},{code:"YF",name:"Canadian Forces"},{code:"C6",name:"CanJet"},{code:"W8",name:"Cargojet Airlines"},{code:"CX",name:"Cathay Pacific Airways"},{code:"9M",name:"Central Mountain Air"},{code:"MG",name:"Champion Air"},{code:"CI",name:"China Airlines"},{code:"MU",name:"China Eastern Airlines"},{code:"CZ",name:"China Southern Airlines"},{code:"DE",name:"Condor Flugdienst"},{code:"DL",name:"Delta Air Lines"},{code:"ES",name:"DHL"},{code:"WK",name:"Edelweiss Air"},{code:"EG",name:"Enerjet"},{code:"BR",name:"EVA Air"},{code:"FX",name:"Federal Express"},{code:"AY",name:"Finnair"},{code:"H3",name:"Harbour Air Ltd."},{code:"BH",name:"Hawkair"},{code:"JB",name:"Helijet International Inc."},{code:"HH1",name:"Highland Helicopters"},{code:"QX",name:"Horizon Air"},{code:"FI",name:"Icelandair"},{code:"IX",name:"Island Express"},{code:"JL",name:"Japan Airlines"},{code:"XC",name:"KD Air Corporation"},{code:"KW",name:"Kelowna Flightcraft"},{code:"KL",name:"KLM"},{code:"KE",name:"Korean Air"},{code:"LA",name:"LAN Airlines"},{code:"LA3",name:"London Air Service"},{code:"LO",name:"LOT Polish Airlines"},{code:"LH",name:"Lufthansa"},{code:"MH",name:"Malaysia Airlines"},{code:"YX",name:"Midwest Airlines"},{code:"NTA",name:"Northern Thunderbird Air Inc."},{code:"ORK",name:"Orca Airways"},{code:"8P",name:"Pacific Coastal Airlines Ltd"},{code:"PR",name:"Philippine Airlines"},{code:"19",name:"Purolator"},{code:"QF",name:"Qantas Airways"},{code:"101",name:"Saltspring Air"},{code:"SK",name:"Scandinavian Airlines SAS"},{code:"21",name:"Seair Seaplanes"},{code:"3U",name:"Sichuan Airlines"},{code:"SQ",name:"Singapore Airlines"},{code:"5G",name:"Skyservice Airlines"},{code:"OO",name:"SkyWest Airlines"},{code:"WG",name:"Sunwing Airlines"},{code:"ZZZ",name:"Swift Air"},{code:"LX",name:"Swiss International Airlines"},{code:"TG",name:"Thai Airways"},{code:"25",name:"Tofino Air"},{code:"UA",name:"United Airlines"},{code:"5X",name:"United Parcel Service"},{code:"US",name:"US Airways"},{code:"VS",name:"Virgin Atlantic Airways"},{code:"8O",name:"West Coast Air"},{code:"WS",name:"WestJet"}];e.timeframes=[{time:"00:00-01:00",base_time:"0"},{time:"01:00-02:00",base_time:"1"},{time:"02:00-03:00",base_time:"2"},{time:"03:00-04:00",base_time:"3"},{time:"04:00-05:00",base_time:"4"},{time:"05:00-06:00",base_time:"5"},{time:"06:00-07:00",base_time:"6"},{time:"07:00-08:00",base_time:"7"},{time:"08:00-09:00",base_time:"8"},{time:"09:00-10:00",base_time:"9"},{time:"10:00-11:00",base_time:"10"},{time:"11:00-12:00",base_time:"11"},{time:"12:00-13:00",base_time:"12"},{time:"13:00-14:00",base_time:"13"},{time:"14:00-15:00",base_time:"14"},{time:"15:00-16:00",base_time:"15"},{time:"16:00-17:00",base_time:"16"},{time:"17:00-18:00",base_time:"17"},{time:"18:00-19:00",base_time:"18"},{time:"19:00-20:00",base_time:"19"},{time:"20:00-21:00",base_time:"20"},{time:"21:00-22:00",base_time:"21"},{time:"22:00-23:00",base_time:"22"},{time:"23:00-00:00",base_time:"23"}];e.formData={};var r=new Array;e.submitTheForm=function(){var n=new Date,i=n.getHours(),s=n.getDate(),o=n.getMonth()+1,u=n.getFullYear();console.log("Current Date: "+s+", Current Month: "+o+": currentYear = "+u+" and currHour = "+i);console.log("--> Submitting form");var a={airport:e.selectedAirport,airline:e.selectedAirline,timeframes:e.selectedTimeFrame},f=angular.element(document.querySelector(".departure")).hasClass("highlight")?"dep":"arr";console.log("Airport = "+a.airport);console.log("Airline = "+a.airline);console.log("Timeframe = "+a.timeframes);console.log("Status = "+f);var l="https://api.flightstats.com/flex/flightstatus/rest/v2/jsonp/airport/status/"+a.airport+"/"+f+"/"+u+"/"+o+"/"+s+"/"+a.timeframes+"?appId=8e5aec87&appKey=ed34be983e971cafe903e442f4bf630e&utc=false&numHours=1&carrier="+a.airline+"&maxFlights=10&callback=JSON_CALLBACK";e.flights=[];e.flighttrackers=[];e.airportList=[];e.flightinfos=[];e.arrivalTime=[];f=="arr"?e.columns=["ARRIVAL TIME","ARRIVING FROM","FLIGHT#"]:f=="dep"&&(e.columns=["DEPARTURE TIME","DEPARTING TO","FLIGHT#"]);e.showAirportStatus=function(){console.log("STATUS = "+f);var e=f=="dep"?"Departing":"Arriving";return e};e.showLocalTime=function(){var t=new Date,n=t.getHours()>=12?"PM":"AM",r=t.getHours();$("#amPM").html(" "+n);$("#currentHour").html(r+":00 "+n);$("#nextHour").html(r+1+":00 "+n);if(e.selectedAirport=="YVR")var i=t.getHours()+":"+t.getMinutes()+" "+n;else var i=t.getHours()+3+":"+t.getMinutes()+" "+n;return i};e.showDate=function(){var e=new Date;return e};t.jsonp(l).success(function(t){console.log(t);e.airportList=t.appendix.airports;e.flighttrackers=t.flightStatuses;r=e.flighttrackers.slice();console.log("flightArray.length = "+r.length);f=="arr"?r.sort(function(e,t){var n=new Date(e.arrivalDate.dateLocal),r=new Date(t.arrivalDate.dateLocal);return n-r}):f=="dep"&&r.sort(function(e,t){var n=new Date(e.departureDate.dateLocal),r=new Date(t.departureDate.dateLocal);return n-r});try{if(r.length>0){angular.element(document.querySelector(".noResultMessage")).css("display")=="block"&&angular.element(document.querySelector(".noResultMessage")).css("display","none");for(var n in r){var i=new Array;if(r[n].hasOwnProperty("codeshares")){for(var s in r[n].codeshares)i.push(""+r[n].codeshares[s].fsCode+""+r[n].codeshares[s].flightNumber);var o=""+r[n].carrierFsCode+""+r[n].flightNumber+","+i,u=o.split(",").sort().join(" / ");r[n].airlineInfos=u}else{var o=""+r[n].carrierFsCode+""+r[n].flightNumber;r[n].airlineInfos=o}}for(var a in r)for(var l in e.airportList)if(f=="arr"){r[a].time=r[a].arrivalDate.dateLocal.slice(11,16);if(r[a].departureAirportFsCode==e.airportList[l].iata){r[a].departureAirportFsCode=""+e.airportList[l].city;r[a].destination=r[a].departureAirportFsCode}}else if(f=="dep"){r[a].time=r[a].departureDate.dateLocal.slice(11,16);r[a].arrivalAirportFsCode==e.airportList[l].iata&&(r[a].arrivalAirportFsCode=""+e.airportList[l].city);r[a].destination=r[a].arrivalAirportFsCode}}else{console.log("NO RESULT CALLED");angular.element(document.querySelector(".noResultMessage")).css("display")=="none"&&angular.element(document.querySelector(".noResultMessage")).css("display","block")}}catch(c){console.log("Error = "+c)}e.flightinfos=r.slice();e.display=!0}).error(function(e){console.log(JSON.stringify(e))})};e.showAirline=function(){var t=new Array;t=e.airlines.slice();for(var n in t)if(t[n].code==e.selectedAirline)return t[n].name};e.showAirport=function(){return e.selectedAirport=="YVR"?"Vancouver International Airport":"Toronto Pearson International Airport"};e.showInitialTime=function(){return e.selectedTimeFrame>=12?e.selectedTimeFrame+":00PM":e.selectedTimeFrame+":00AM"};e.showEndTime=function(){var t=parseInt(e.selectedTimeFrame),n;t+1==23?n=0:t<=23&&(n=t+1);return n>=12?n+":00PM":n+":00AM"}});